import{P as L}from"./index-DmvVZzf-.js";import{bq as N,b4 as S}from"./entry/index-C2yXXbfE-1713597257644.js";import{E as B,a0 as E}from"./antd-D-XvgdAE.js";import{d as D,r as I,h as O,c as u,a9 as f,Z as m,a7 as P,a8 as r,$ as e,k as o,u as l,G as p,a0 as c,_ as h,F as W,aa as A}from"./vue-bWmcvXqU.js";import"./useContentViewHeight-ByP0kkZI.js";import"./useWindowSizeFn-rAoW7C_Y.js";import"./onMountedOrActivated-C5rGMWQz.js";const F={class:"flex"},M={class:"w-1/3 bg-white p-4"},U={class:"flex items-center"},q=e("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1),G=e("hr",{class:"my-4"},null,-1),J={class:"flex"},R=e("p",{class:"text-lg font-medium mt-4"},"设置",-1),Z=e("hr",{class:"my-4"},null,-1),$={class:"w-2/3 bg-white ml-4 p-4"},j=e("span",{class:"text-lg font-medium mr-4"}," 消息记录: ",-1),z=e("hr",{class:"my-4"},null,-1),H={class:"max-h-80 overflow-auto"},K={class:"flex items-center"},Q=e("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1),ne=D({__name:"index",setup(X){const g=B.TextArea,t=I({server:"ws://localhost:3300/test",sendValue:"",recordList:[]}),{status:_,data:i,send:b,close:x,open:y}=N(t.server,{autoReconnect:!1,heartbeat:!0});O(()=>{if(i.value)try{const d=JSON.parse(i.value);t.recordList.push(d)}catch(d){t.recordList.push({res:i.value,id:Math.ceil(Math.random()*1e3),time:new Date().getTime()})}});const a=u(()=>_.value==="OPEN"),k=u(()=>a.value?"success":"red"),w=u(()=>[...t.recordList].reverse());function T(){b(t.sendValue),t.sendValue=""}function V(){a.value?x():y()}return(d,n)=>{const C=f("a-input"),v=f("a-button");return m(),P(l(L),{title:"WebSocket 示例"},{default:r(()=>[e("div",F,[e("div",M,[e("div",U,[q,o(l(E),{color:k.value},{default:r(()=>[p(c(l(_)),1)]),_:1},8,["color"])]),G,e("div",J,[o(C,{value:t.server,"onUpdate:value":n[0]||(n[0]=s=>t.server=s),"addon-before":"服务地址",disabled:""},null,8,["value"]),o(v,{type:a.value?"danger":"primary",onClick:V},{default:r(()=>[p(c(a.value?"关闭连接":"开启连接"),1)]),_:1},8,["type"])]),R,Z,o(l(g),{placeholder:"需要发送到服务器的内容",disabled:!a.value,value:t.sendValue,"onUpdate:value":n[1]||(n[1]=s=>t.sendValue=s),allowClear:""},null,8,["disabled","value"]),o(v,{type:"primary",block:"",class:"mt-4",disabled:!a.value,onClick:T},{default:r(()=>[p(" 发送 ")]),_:1},8,["disabled"])]),e("div",$,[j,z,e("div",H,[e("ul",null,[(m(!0),h(W,null,A(w.value,s=>(m(),h("li",{class:"mt-2",key:s.time},[e("div",K,[Q,e("span",null,c(l(S)(s.time)),1)]),e("div",null,c(s.res),1)]))),128))])])])])]),_:1})}}});export{ne as default};
